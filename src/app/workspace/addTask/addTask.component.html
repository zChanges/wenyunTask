<nz-tabset>
  <nz-tab>
    <ng-template #nzTabHeading>
      新增任务
    </ng-template>

    <form class="form-horizontal" nz-form [formGroup]="validateForm" >
      <div class="form-group" nz-form-item>
        <label for="inputEmail3" class="col-sm-2 control-label">标题</label>
        <div class="col-sm-6" nz-form-control [nzValidateStatus]="validateForm.controls.title">
          <nz-input [nzSize]="'large'" [(ngModel)]="title" formControlName="title"  [nzPlaceHolder]="'请输入标题'"></nz-input>
          <!-- <div nz-form-explain *ngIf="validateForm.controls.title.dirty&&validateForm.controls.title.hasError('required')">Please input your username!</div> -->
        </div>
      </div>

      <div class="form-group" nz-form-item>
        <label class="col-sm-2 control-label">产品</label>
        <div class="col-sm-4" nz-form-control [nzValidateStatus]="validateForm.controls.productId">
            <nz-select style="width: 100%;" formControlName="productId" [(ngModel)]="productId" nzAllowClear [nzSize]="'large'">
              <nz-option [nzLabel]="'请选择'" [nzValue]="''"></nz-option>    
              <nz-option 
                *ngFor="let item of searchOptions" 
                [nzLabel]="item.label"
                [nzValue]="item.value"
                ></nz-option>
            </nz-select>
        </div>
        <button nz-button (click)="isProduct=true"  [nzType]="'primary'" [nzGhost]="true">
          <span>修改</span>
        </button>
      </div>

      <div class="form-group" nz-form-item>
          <label class="col-sm-2 control-label">项目</label>
          <div class="col-sm-4" nz-form-control [nzValidateStatus]="validateForm.controls.projectId">
              <nz-select style="width: 100%;" formControlName="projectId" [(ngModel)]="projectId" nzAllowClear [nzSize]="'large'">
                <nz-option [nzLabel]="'请选择'" [nzValue]="''"></nz-option>  
                <nz-option 
                *ngFor="let item of searchOptions" 
                [nzLabel]="item.label"
                [nzValue]="item.value"
                ></nz-option>
              </nz-select>
          </div>
          <button nz-button (click)="isProject=true"  [nzType]="'primary'" [nzGhost]="true">
            <span>修改</span>
          </button>
        </div>

      
        <div class="form-group" nz-form-item>
        <label class="col-sm-2 control-label">版本</label>
        <div class="col-sm-4" nz-form-control [nzValidateStatus]="validateForm.controls.versionId">
            <nz-select style="width: 100%;" formControlName="versionId" [(ngModel)]="versionId" nzAllowClear [nzSize]="'large'">
              <nz-option [nzLabel]="'请选择'" [nzValue]="''"></nz-option>  
              <nz-option 
              *ngFor="let item of searchOptions" 
              [nzLabel]="item.label"
              [nzValue]="item.value"
              ></nz-option>
            </nz-select>
        </div>
        <button nz-button (click)="isVersion=true"  [nzType]="'primary'" [nzGhost]="true">
          <span>修改</span>
        </button>
      </div>

      <div class="form-group" nz-form-item>
        <label class="col-sm-2 control-label">联调时间</label>
        <div class="col-sm-2" nz-form-control [nzValidateStatus]="validateForm.controls.devFinish">
           <nz-datepicker  [nzShowTime]="true" [nzPlaceHolder]="'联调时间'" formControlName="devFinish" [(ngModel)]="devFinish"  [nzFormat]="'YYYY-MM-DD HH:mm:ss'"></nz-datepicker>
        </div>

        <label class="col-sm-1 control-label">提测时间</label>
        <div class="col-sm-2" nz-form-control [nzValidateStatus]="validateForm.controls.testStart">
          <nz-datepicker  [nzShowTime]="true" [nzPlaceHolder]="'提测时间'" formControlName="testStart" [(ngModel)]="testStart" [nzFormat]="'YYYY-MM-DD HH:mm:ss'"></nz-datepicker>
        </div>
      </div>

      <div class="form-group" nz-form-item>
        <label class="col-sm-2 control-label">测试完成时间</label>
        <div class="col-sm-2" nz-form-control [nzValidateStatus]="validateForm.controls.testFinish">
          <nz-datepicker  [nzShowTime]="true" [nzPlaceHolder]="'测试完成时间'" formControlName="testFinish" [(ngModel)]="testFinish" [nzFormat]="'YYYY-MM-DD HH:mm:ss'"></nz-datepicker>
        </div>

        <label class="col-sm-1 control-label">验收完成时间</label>
        <div class="col-sm-2" nz-form-control [nzValidateStatus]="validateForm.controls.acceptFinish">
          <nz-datepicker  [nzShowTime]="true" [nzPlaceHolder]="'验收完成时间'" formControlName="acceptFinish" [(ngModel)]="acceptFinish" [nzFormat]="'YYYY-MM-DD HH:mm:ss'"></nz-datepicker>
        </div>
      </div>

      <div class="form-group" nz-form-item>
        <label class="col-sm-2 control-label">详细描述</label>
        <div class="col-sm-6" nz-form-control [nzValidateStatus]="validateForm.controls.description">
            <nz-input [(ngModel)]="description" formControlName="description" [nzType]="'textarea'" [nzRows]="'5'" [nzPlaceHolder]="''"></nz-input>
        </div>
      </div>

      <div class="form-group" nz-form-item>
          <label class="col-sm-2 control-label">任务类型</label>
          <div class="col-sm-6" nz-form-control [nzValidateStatus]="validateForm.controls.taskState">
              <nz-radio-group [(ngModel)]="type" formControlName="taskState" (click)="changeTask()">
                  <label nz-radio [nzValue]="'200'">
                    <span>需求</span>
                  </label>
                  <label nz-radio [nzValue]="'201'">
                    <span>BUG</span>
                  </label>
                </nz-radio-group>
          </div>
      </div>


      <div class="form-group" *ngIf="isTaskState">
          <label class="col-sm-2 control-label"></label>
          <div class="col-sm-2">
            <nz-select style="width: 155px;" [nzPlaceHolder]="'开发'" [nzMode]="'multiple'" formControlName='multipleSelect' [(ngModel)]="multipleSelected" [nzSize]="size">
                <nz-option
                  *ngFor="let option of searchOptions"
                  [nzLabel]="option.label"
                  [nzValue]="option"
                  >
                </nz-option>
              </nz-select>
          </div>
      </div>

      <div class="form-group" *ngIf="isTaskState">
        <label class="col-sm-2 control-label"></label>
        <div class="col-sm-10">
           <div *ngFor="let item of multipleSelected">
             <div class="form-group">
                <div class="col-sm-2">
                    <label class="control-label">{{item.label}}</label>
                    <!-- <select  class="form-control days">
                      <option *ngFor='let item of workLoadList' value="{{item.value}}">{{item.text}}</option>
                    </select> -->
                    <nz-select  style="width: 75px;"  class="days">
                        <!-- <nz-option [nzLabel]="'请选择'" [nzValue]="''"></nz-option>   -->
                        <nz-option 
                            *ngFor='let item of workLoadList'
                            [nzLabel]="item.text"
                            [nzValue]="item.value"
                          >{{item.text}}</nz-option>
                      </nz-select>
                </div>
             </div>
           </div>
        </div>
      </div>

      <!-- <div class="form-group" *ngIf="!isTaskState">
        <label class="col-sm-2 control-label"></label>
        <div class="col-sm-10">

        </div>



      </div> -->

      
      <div class="form-group" nz-form-item>
          <label class="col-sm-2 control-label">工作量</label>
          <div class="col-sm-4" nz-form-control [nzValidateStatus]="validateForm.controls.workLoad">
              <nz-select [(ngModel)]="workLoad" formControlName="workLoad" style="width: 100%;"  nzAllowClear [nzSize]="'large'">
                <nz-option [nzLabel]="'请选择'" [nzValue]="''"></nz-option>  
                <nz-option 
                    *ngFor='let item of workLoadList'
                    [nzLabel]="item.text"
                    [nzValue]="item.value"
                  >{{item.text}}</nz-option>
              </nz-select>
          </div>
      </div>

      <div class="form-group" nz-form-item>
          <label class="col-sm-2 control-label">附件</label>
          <div class="col-sm-4">
              <input type="file">
          </div>
      </div>


      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-8">
          <button  nz-button [disabled]="!validateForm.valid" [nzType]="'primary'" (click)="save($event)" [nzLoading]="isLoading">
            <i class="anticon anticon-save"></i>
            <span>确定</span>
          </button>
        </div>
      </div>
    </form>

  </nz-tab>
</nz-tabset>

<!-- 修改产品模态框 -->
<nz-modal [nzVisible]="isProduct" [nzTitle]="'产品'" [nzContent]="modalProduct" (nzOnCancel)="isProduct=false" (nzOnOk)="isProduct=false">
  <ng-template #modalProduct>
    产品
  </ng-template>
</nz-modal>

<!-- 修改项目模态框 -->
<nz-modal [nzVisible]="isProject" [nzTitle]="'项目'" [nzContent]="modalProject" (nzOnCancel)="isProject=false" (nzOnOk)="isProject=false">
  <ng-template #modalProject>
    项目
  </ng-template>
</nz-modal>

<!-- 修改版本模态框 -->
<nz-modal [nzVisible]="isVersion" [nzTitle]="'版本'" [nzContent]="modalVersion" (nzOnCancel)="isVersion=false" (nzOnOk)="isVersion=false">
  <ng-template #modalVersion>
    版本
  </ng-template>
</nz-modal>