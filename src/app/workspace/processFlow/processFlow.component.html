<nz-tabset>
  <nz-tab>
    <ng-template #nzTabHeading>
      任务处理过程
    </ng-template>

    <div class="rowFlow">
        <nz-collapseset [nzAccordion]="true">
            <nz-collapse  [nzTitle]="'流程图'" [nzActive]="true">

              <div class="flowChart">
                    
                <nz-popover [nzTitle]="'开发'" style="float:left">
                    <button nz-button nz-popover [nzType]="'primary'" [nzSize]="'large'" [ngClass]="{styleClass: todoStatus >= 102 }">
                        <span>开发</span>
                    </button>
                    <ng-template #nzTemplate >
                        <div *ngFor="let item of duty1">
                            <span>{{item}}</span>
                        </div>
                    </ng-template>
                </nz-popover>

                <div class="guide guideColor">
                  <div class="arrows"></div>
                      <span *ngIf="isBug" class="guideTime">{{detialData.devFinish | date:'y-MM-dd HH:mm:ss'}}</span>
                </div>

                <nz-popover *ngIf="isBug" [nzTitle]="'联调'" style="float:left" >
                    <button nz-button nz-popover [nzType]="'primary'" [nzSize]="'large'" [ngClass]="{styleClass:todoStatus >= 102.5 }">
                        <span>联调</span>
                    </button>
                    <ng-template #nzTemplate>
                        <div *ngFor="let item of duty2">
                            <span>{{item}}</span>
                        </div>
                    </ng-template>
                </nz-popover>

                <div class="guide guideColor" *ngIf="isBug">
                  <div class="arrows"></div>
                  <span class="guideTime">{{detialData.testFinish | date:'y-MM-dd HH:mm:ss'}}</span>
                </div>

                <nz-popover [nzTitle]="'测试'" style="float:left">
                    <button nz-button nz-popover [nzType]="'primary'" [nzSize]="'large'" [ngClass]="{styleClass:todoStatus >= 103}">
                        <span>测试人员</span>
                    </button>
                    <ng-template #nzTemplate>
                        <div *ngFor="let item of duty3">
                            <span>{{item}}</span>
                        </div>
                    </ng-template>
                </nz-popover>
               
                <div class="guide guideColor"  *ngIf="isBug">
                  <div class="arrows"></div>
                  <span class="guideTime">{{detialData.acceptFinish | date:'y-MM-dd HH:mm:ss'}}</span>
                </div>

                <nz-popover *ngIf="isBug" [nzTitle]="'产品人员'" style="float:left">
                    <button nz-button nz-popover [nzType]="'primary'" [nzSize]="'large'" [ngClass]="{styleClass:todoStatus >= 105 }">
                        <span>产品人员</span>
                    </button>
                    <ng-template #nzTemplate>
                        <div *ngFor="let item of duty4">
                            <span>{{item}}</span>
                        </div>
                    </ng-template>
                </nz-popover>

              </div>


            </nz-collapse>
        </nz-collapseset>
    </div>

  <div class="rowFlow">
    <nz-collapseset [nzAccordion]="true">
        <nz-collapse  [nzTitle]="'标题'" [nzActive]="true">
            <div nz-row  [nzGutter]="40">
                <div nz-col [nzSpan]="6">
                  <div nz-form-item nz-row>
                    <div nz-form-label nz-col [nzSpan]="8">
                      <label>标题</label>
                    </div>
                    <div nz-form-control nz-col [nzSpan]="16">
                      {{detialData.title}}
                    </div>
                  </div>
                </div>
          
                <div nz-col [nzSpan]="6">
                  <div nz-form-item nz-row>
                    <div nz-form-label nz-col [nzSpan]="8">
                      <label>描述</label>
                    </div>
                    <div nz-form-control nz-col [nzSpan]="16">
                      {{detialData.description}}
                    </div>
                  </div>
                </div>
          
                <div nz-col [nzSpan]="6">
                  <div nz-form-item nz-row>
                    <div nz-form-label nz-col [nzSpan]="8">
                      <label>项目</label>
                    </div>
                    <div nz-form-control nz-col [nzSpan]="16">
                      {{detialData.projectStr}}
                    </div>
                  </div>
                </div>
          
                <div nz-col [nzSpan]="6">
                  <div nz-form-item nz-row>
                    <div nz-form-label nz-col [nzSpan]="8">
                      <label>版本</label>
                    </div>
                    <div nz-form-control nz-col [nzSpan]="16">
                        {{detialData.versionStr}}
                    </div>
                  </div>
                </div>

                <div nz-col [nzSpan]="6">
                  <div nz-form-item nz-row>
                    <div nz-form-label nz-col [nzSpan]="8">
                      <label>产品</label>
                    </div>
                    <div nz-form-control nz-col [nzSpan]="16">
                        {{detialData.productStr}}
                    </div>
                  </div>
                </div>
          
                <!-- 分割 -->
                <div nz-col [nzSpan]="6">
                  <div nz-form-item nz-row>
                    <div nz-form-label nz-col [nzSpan]="8">
                      <label>类型</label>
                    </div>
                    <div nz-form-control nz-col [nzSpan]="16">
                      {{detialData.type}}
                    </div>
                  </div>
                </div>

                <div nz-col [nzSpan]="6">
                    <div nz-form-item nz-row>
                      <div nz-form-label nz-col [nzSpan]="8">
                        <label>当前状态</label>
                      </div>
                      <div nz-form-control nz-col [nzSpan]="16">
                        {{detialData.todoStatusStr}}
                      </div>
                    </div>
                  </div>

                  <div nz-col [nzSpan]="6">
                      <div nz-form-item nz-row>
                        <div nz-form-label nz-col [nzSpan]="8">
                          <label>工作量</label>
                        </div>
                        <div nz-form-control nz-col [nzSpan]="16">
                          {{detialData.workLoad}}天
                        </div>
                      </div>
                    </div>

                    <div nz-col [nzSpan]="6">
                        <div nz-form-item nz-row>
                          <div nz-form-label nz-col [nzSpan]="8">
                            <label>开发完成时间</label>
                          </div>
                          <div nz-form-control nz-col [nzSpan]="16">
                            {{detialData.devFinish | date:'y-MM-dd HH:mm:ss'}}
                          </div>
                        </div>
                      </div>

                      <div nz-col [nzSpan]="6">
                          <div nz-form-item nz-row>
                            <div nz-form-label nz-col [nzSpan]="8">
                              <label>测试完成时间</label>
                            </div>
                            <div nz-form-control nz-col [nzSpan]="16">
                              {{detialData.testFinish | date:'y-MM-dd HH:mm:ss'}}
                            </div>
                          </div>
                        </div>

                        <div nz-col [nzSpan]="6" style="float:right">
                          <div nz-form-item nz-row>
                            <div nz-form-label nz-col [nzSpan]="8">
                              <label>附件下载</label>
                            </div>
                            <div nz-form-control nz-col [nzSpan]="16">
                                <button nz-button [nzType]="'primary'" [disabled]='detialData.fileId == -1' (click)="getFile(detialData.fileId)">
                                    <i class="anticon anticon-download"></i><span>下载附件</span>
                                </button>
                            </div>
                          </div>
                        </div>
            </div>
        </nz-collapse>
    </nz-collapseset>
  </div>

  <div class="search-result-list">
    <div></div>
      <div nz-form-item nz-row>
          <div nz-col [nzSm]="24" [nzXs]="24" class="context-title">
              <label><h4>任务单列表</h4></label>
          </div>
      </div>
      <div class="table" style="margin-top:20px">
        <nz-table #nzTable [nzDataSource]="data" [nzPageSize]="10">
            <thead nz-thead>
              <tr>
                <th nz-th [nzExpand]="true"></th>
                <!-- <th nz-th><span>标题</span></th> -->
                <th nz-th><span>处理人</span></th>
                <th nz-th><span>处理时间</span></th>
                <th nz-th><span>处理方式</span></th>
                <th nz-th><span>状态</span></th>
                <th nz-th><span>操作</span></th>
              </tr>
            </thead>
            <tbody nz-tbody>
              <ng-template ngFor let-data [ngForOf]="nzTable.data">
                  <tr nz-tbody-tr>
                      <td nz-td [nzExpand]="true">
                        <nz-row-expand-icon [(nzExpand)]="data.expand"></nz-row-expand-icon>
                      </td>
                      <td nz-td style="color:#E8791A;font-size:14px;"><b>{{data.createUserName}}</b></td>
                      <td nz-td>{{data.createData | date:'y-MM-dd HH:mm:ss'}}</td>
                      <td nz-td [ngClass]="{pass: data.status == 1 , repulse: data.status == 0}">{{data.statusStr}}</td>
                      <td nz-td>{{data.todoStatusStr}}</td>
                      <td nz-td>
                            <button nz-button [nzType]="'primary'" [nzSize]="'small'" [nzShape]="'circle'" [disabled]='data.fileId == -1' (click)="getFile(data.fileId)">
                                <i class="anticon anticon-download"></i>
                            </button>
                      </td>
                  </tr>
                  <tr nz-tbody-tr *ngIf="data.expand">
                      <td nz-td></td>
                      <td nz-td colspan="3">
                        <b class="data-title">标题：</b>{{data.title}}<br/>
                        <b class="data-title">描述：</b> {{data.description}}
                      </td>
                      <td nz-td></td>
                      <td nz-td></td>
                  </tr>
              </ng-template>
          </tbody>
        </nz-table>
      </div>
      
  </div>


  </nz-tab>
</nz-tabset>